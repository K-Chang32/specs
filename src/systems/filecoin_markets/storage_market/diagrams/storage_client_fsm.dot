digraph finite_state_machine {
  rankdir=LR;
  size="8,5"
  node [shape = circle];

  { // states
    SStart
    SSetup
  }

  SStart -> AFindMiner
  AFindMiner -> SSetup

  SSetup -> APreparePiece
  APreparePiece -> SDealMaking

  SDealMaking -> ASendDealProposal
  ASendDealProposal -> SDealMaking

  SDealMaking -> AGetAcceptedDeal
  AGetAcceptedDeal -> SDealMadeNotDone

  { // may
    edge [style=dashed]

    SDealMadeNotDone -> APostDealOnChain
    APostDealOnChain -> SDealMadeDone
  }

  SDealMadeDone -> APostDealOnChain
  APostDealOnChain -> SDealMadeDone


}
